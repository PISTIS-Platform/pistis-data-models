@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix pst: <https://www.pistis-project.eu/ns/voc#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix dcatap: <http://data.europa.eu/r5r/> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix pv: <https://piveau.eu/ns/voc#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix odrl: <http://www.w3.org/ns/odrl/2/> .
@prefix vcard: <http://www.w3.org/2006/vcard/ns#> .

pv:PISTIS
    a pv:PiveauProfile ;
    pv:profileVersion "1" ;
    dct:title "A DCAT-AP profile for PISTIS"@en ;
    dct:description "Based and inspired by DCAT-AP 2.1.1"@en ;
    owl:versionInfo "0.0.1" .

dcatap:Dataset_Shape
    a sh:NodeShape ;
    sh:name "Dataset"@en ;
    sh:property [
          pv:mappingClass "SimpleMultiLangTitle" ;
          pv:mappingName "title" ;
          sh:minCount 1 ;
          sh:nodeKind sh:Literal ;
          sh:path dct:title ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "SimpleMultiLang" ;
          pv:mappingName "description" ;
          sh:minCount 1 ;
          sh:nodeKind sh:Literal ;
          sh:path dct:description ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "Keywords" ;
          pv:mappingName "keywords" ;
          sh:nodeKind sh:Literal ;
          sh:path dcat:keyword ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "Language" ;
          pv:mappingName "language" ;
          sh:path dct:language ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "Agent" ;
          pv:mappingName "creator" ;
          sh:maxCount 1 ;
          sh:path dct:creator ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "ContactPoint" ;
          pv:mappingName "contact_point" ;
          sh:path dcat:contactPoint ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "DateTime" ;
          pv:mappingName "issued" ;
          sh:maxCount 1 ;
          sh:path dct:issued ;
          sh:severity sh:Violation ;
          sh:shape dcatap:DateOrDateTimeDataType_Shape ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingLink dcatap:Distribution_Shape ;
          pv:mappingName "distributions" ;
          sh:path dcat:distribution ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "Theme" ;
          pv:mappingName "categories" ;
          sh:path dcat:theme ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "id" ;
          sh:maxCount 1 ;
          sh:description "Required property for piveau base functionality." ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingName "catalog_record" ;
          pv:mappingProperty [
                              pv:mappingClass "DateTime" ;
                              pv:mappingName "issued" ;
                              sh:maxCount 1 ;
                          ] ;
          pv:mappingProperty [
                              pv:mappingClass "DateTime" ;
                              pv:mappingName "modified" ;
                              sh:maxCount 1 ;
                          ] ;
          sh:maxCount 1 ;
          sh:description "Required property for piveau base functionality." ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingName "catalog" ;
          pv:mappingProperty [
                              pv:mappingClass "StandardText" ;
                              pv:mappingName "id" ;
                              sh:maxCount 1 ;
                              sh:minCount 1 ;
                          ] ;
          sh:maxCount 1 ;
          sh:description "Required property for piveau base functionality." ;
      ] ;
    sh:property [
          sh:maxCount 1 ;
          pv:mappingClass "SpatialResource" ;
          pv:mappingName "country" ;
          sh:description "Required property for piveau base functionality." ;
      ] ;
    sh:property [
          pv:mappingClass "Metrics" ;
          pv:mappingName "quality_meas" ;
          sh:maxCount 1 ;
          sh:description "Required property for piveau base functionality." ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingLink pst:MonetizationMethod_Shape ;
          pv:mappingName "monetization" ;
          sh:path pst:monetization ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingLink pst:Offer_Shape ;
          pv:mappingName "offer" ;
          sh:path pst:offer ;
          sh:severity sh:Violation ;
      ] ;
    sh:targetClass dcat:Dataset .

dcatap:Distribution_Shape
    a sh:NodeShape ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "id" ;
          sh:maxCount 1 ;
          sh:description "Required property for piveau base functionality." ;
      ] ;
    sh:property [
          pv:mappingClass "License" ;
          pv:mappingName "license" ;
          sh:maxCount 1 ;
          sh:path dct:license ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "Format" ;
          pv:mappingName "format" ;
          sh:maxCount 1 ;
          sh:path dct:format ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "StandardDisabled" ;
          pv:mappingName "access_url" ;
          sh:minCount 1 ;
          sh:nodeKind sh:BlankNodeOrIRI ;
          sh:path dcat:accessURL ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "SimpleMultiLang" ;
          pv:mappingName "title" ;
          sh:nodeKind sh:Literal ;
          sh:path dct:title ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "StandardDisabled" ;
          pv:mappingName "download_url" ;
          sh:nodeKind sh:BlankNodeOrIRI ;
          sh:path dcat:downloadURL ;
          sh:severity sh:Violation ;
      ] ;
    sh:property [
          pv:mappingClass "SimpleMultiLang" ;
          pv:mappingName "description" ;
          sh:nodeKind sh:Literal ;
          sh:path dct:description ;
          sh:severity sh:Violation ;
      ] ;
    sh:targetClass dcat:Distribution .

pst:MonetizationMethod_Shape
    a sh:NodeShape ;
    sh:property [
          pv:mappingClass "License" ;
          pv:mappingName "license" ;
          sh:maxCount 1 ;
          sh:path dct:license ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingLink dcatap:Agent_Shape ;
          pv:mappingName "publisher" ;
          sh:maxCount 1 ;
          sh:path dct:publisher ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "access_policies" ;
          sh:maxCount 1 ;
          sh:path pst:accessPolicies ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "additional_renewal_terms" ;
          sh:maxCount 1 ;
          sh:path pst:additionalRenewalTerms ;
      ] ;
    sh:property [
          pv:mappingClass "Integer" ;
          pv:mappingName "contract_breach_days" ;
          sh:maxCount 1 ;
          sh:path pst:contractBreachDays ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "extra_terms" ;
          sh:maxCount 1 ;
          sh:path pst:extraTerms ;
      ] ;
    sh:property [
          pv:mappingClass "Boolean" ;
          pv:mappingName "free" ;
          sh:maxCount 1 ;
          sh:path pst:free ;
      ] ;
    sh:property [
          pv:mappingClass "Boolean" ;
          pv:mappingName "is_exclusive" ;
          sh:maxCount 1 ;
          sh:path pst:isExclusive ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingLink pst:DownloadLimit_Shape ;
          pv:mappingName "downloads" ;
          sh:path pst:limit ;
      ] ;
    sh:property [
          pv:mappingClass "Integer" ;
          pv:mappingName "non_renewal_days" ;
          sh:maxCount 1 ;
          sh:path pst:nonRenewalDays ;
      ] ;
    sh:property [
          pv:mappingClass "Nested" ;
          pv:mappingLink pst:PersonalDataTerms_Shape ;
          pv:mappingName "personal_data_terms" ;
          sh:path pst:personalData ;
      ] ;
    sh:property [
          pv:mappingClass "Integer" ;
          pv:mappingName "price" ;
          sh:maxCount 1 ;
          sh:path pst:price ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "spatial_availability" ;
          sh:maxCount 1 ;
          sh:path pst:spatialAvailability ;
      ] ;
    # termData
    sh:property [
          pv:mappingClass "DateTime" ;
          pv:mappingName "termDate" ;
          sh:maxCount 1 ;
          sh:path pst:termDate ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "transferable" ;
          sh:maxCount 1 ;
          sh:path pst:transferable ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "type" ;
          sh:maxCount 1 ;
          sh:path pst:type ;
      ] ;
    sh:targetClass pst:MonetizationMethod .

dcatap:Agent_Shape
    a sh:NodeShape ;
    sh:name "Agent"@en ;
    sh:property [
          sh:maxCount 1 ;
          sh:nodeKind sh:Literal ;
          sh:path foaf:name ;
          pv:mappingClass "StandardText" ;
          pv:mappingName "name";
          sh:severity sh:Violation
      ], [
          sh:maxCount 1 ;
          sh:path foaf:homepage ;
          sh:severity sh:Violation ;
          pv:mappingClass "StandardDisabled" ;
          pv:mappingName "homepage"
      ], [
          sh:maxCount 1 ;
          sh:path foaf:mbox ;
          sh:severity sh:Violation ;
          pv:mappingClass "StandardDisabled" ;
          pv:mappingName "email"
      ], [
          sh:maxCount 1 ;
          sh:path dct:type ;
          sh:severity sh:Violation
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "organization_id" ;
          sh:maxCount 1 ;
          sh:path pst:organizationId ;
      ] ;
    sh:targetClass foaf:Agent .

pst:DownloadLimit_Shape
    a sh:NodeShape ;
    sh:property [
          pv:mappingClass "Integer" ;
          pv:mappingName "downloads" ;
          sh:maxCount 1 ;
          sh:path pst:downloads ;
      ] ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "frequency" ;
          sh:maxCount 1 ;
          sh:path pst:frequency ;
      ] ;
    sh:targetClass pst:DownloadLimit .

pst:PersonalDataTerms_Shape
    a sh:NodeShape ;
    sh:property [
          pv:mappingClass "StandardText" ;
          pv:mappingName "personal_data_terms" ;
          sh:maxCount 1 ;
          sh:path pst:personalDataTerms ;
      ] ;
    sh:property [
          pv:mappingClass "Boolean" ;
          pv:mappingName "contains_personal_data" ;
          sh:maxCount 1 ;
          sh:path pst:containsPersonalData ;
      ] ;
    sh:targetClass pst:PersonalDataTerms .

pst:Offer_Shape
    a sh:NodeShape ;
    sh:property [
          pv:mappingClass "StandardText" ; # Should be UUID
          pv:mappingName "original_ID" ;
          sh:maxCount 1 ;
          sh:path pst:originalID ;
      ] ;
    sh:targetClass pst:OfferShape .
#-------------------------------------------------------------------------
# New Property Definitions under the pistis Namespace
#-------------------------------------------------------------------------

# Dataset properties
pst:organizationId a rdf:Property ;
                      rdfs:label "User Organization ID"@en ;
                      rdfs:comment "User's organization ID"@en ;
                      rdfs:domain dcat:Dataset ;
                      rdfs:range xsd:string .

pst:isExclusive a rdf:Property ;
                   rdfs:label "Is Exclusive"@en ;
                   rdfs:comment "Indicates if the dataset is exclusive"@en ;
                   rdfs:domain dcat:Dataset ;
                   rdfs:range xsd:boolean .

pst:free a rdf:Property ;
            rdfs:label "Free"@en ;
            rdfs:comment "Indicates if the dataset is free"@en ;
            rdfs:domain dcat:Dataset ;
            rdfs:range xsd:boolean .

pst:transferable a rdf:Property ;
                    rdfs:label "Transferable"@en ;
                    rdfs:comment "Transferability of the dataset (transferable, non-transferable, sub-licensable)"@en ;
                    rdfs:domain dcat:Dataset ;
                    rdfs:range xsd:string .

pst:accessPolicies a rdf:Property ;
                      rdfs:label "Access Policies"@en ;
                      rdfs:comment "Access policies for the dataset"@en ;
                      rdfs:domain dcat:Dataset ;
                      rdfs:range odrl:Set .

pst:additionalRenewalTerms a rdf:Property ;
                              rdfs:label "Additional Renewal Terms"@en ;
                              rdfs:comment "Additional terms for contract renewal"@en ;
                              rdfs:domain dcat:Dataset ;
                              rdfs:range xsd:string .

pst:contractBreachDays a rdf:Property ;
                          rdfs:label "Contract Breach Days"@en ;
                          rdfs:comment "Maximum days for curing contract breach"@en ;
                          rdfs:domain dcat:Dataset ;
                          rdfs:range xsd:integer .

pst:extraTerms a rdf:Property ;
                  rdfs:label "Extra Terms"@en ;
                  rdfs:comment "Any extra terms added by the user"@en ;
                  rdfs:domain dcat:Dataset ;
                  rdfs:range xsd:string .

pst:originalID a rdf:Property ;
                  rdfs:label "Original ID"@en ;
                  rdfs:comment "The offer original ID"@en ;
                  rdfs:domain dcat:Dataset ;
                  rdfs:range xsd:string . # Should be UUID

pst:nonRenewalDays a rdf:Property ;
                      rdfs:label "Non-Renewal Days"@en ;
                      rdfs:comment "Notice period for non-renewal of contract"@en ;
                      rdfs:domain dcat:Dataset ;
                      rdfs:range xsd:integer .

pst:personalDataTerms a rdf:Property ;
                         rdfs:label "Personal Data Terms"@en ;
                         rdfs:comment "Protection of personal data terms"@en ;
                         rdfs:domain dcat:Dataset ;
                         rdfs:range xsd:string .

pst:price a rdf:Property ;
             rdfs:label "Dataset Price"@en ;
             rdfs:comment "The price at which the user sells the dataset"@en ;
             rdfs:domain dcat:Dataset ;
             rdfs:range xsd:decimal .

pst:type a rdf:Property ;
            rdfs:label "Monetization Type"@en ;
            rdfs:comment "Monetization Type such as one-off, subscription, etc."@en ;
            rdfs:domain dcat:Dataset ;
            rdfs:range xsd:string .

pst:termDate a rdf:Property ;
                rdfs:label "Term Date"@en ;
                rdfs:comment "Perpetual or duration of the term"@en ;
                rdfs:domain dcat:Dataset ;
                rdfs:range xsd:date .

pst:insightsResult a rdf:Property ;
                      rdfs:label "Insights Result"@en ;
                      rdfs:comment "Results of insights generator"@en ;
                      rdfs:domain dcat:Dataset ;
                      rdfs:range xsd:string .
